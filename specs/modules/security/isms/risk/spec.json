{
  "entity": "risk",
  "namespace": "security.isms",
  "label": "Risk",
  "id": "risk_id",
  "routing": {
    "list": "/security/risks",
    "detail": "/security/risks/[risk_id]"
  },
  "permissions": {
    "read": ["Security", "Auditor", "Admin", "Owner"],
    "write": ["Security", "Admin", "Owner"],
    "scope": "org_id"
  },
  "fields": [
    {
      "name": "risk_id",
      "type": "uuid",
      "required": true
    },
    {
      "name": "title",
      "type": "string",
      "required": true,
      "search": {
        "fts": true
      }
    },
    {
      "name": "description",
      "type": "text",
      "required": false,
      "search": {
        "fts": true,
        "vector": true
      }
    },
    {
      "name": "owner_id",
      "type": "uuid",
      "required": true,
      "ref": "people.person"
    },
    {
      "name": "likelihood",
      "type": "enum",
      "values": ["low", "medium", "high"],
      "default": "medium",
      "required": true
    },
    {
      "name": "impact",
      "type": "enum",
      "values": ["low", "medium", "high"],
      "default": "medium",
      "required": true
    },
    {
      "name": "level",
      "type": "enum",
      "values": ["low", "medium", "high", "critical"],
      "computed": true,
      "expr": "risk_level(likelihood, impact)"
    },
    {
      "name": "status",
      "type": "enum",
      "values": ["open", "mitigating", "accepted", "closed"],
      "default": "open",
      "required": true
    }
  ],
  "table": {
    "columns": ["title", "owner_id", "likelihood", "impact", "level", "status"],
    "defaultSort": ["level", "desc"],
    "filters": ["owner_id", "status", "likelihood", "impact", "level"]
  },
  "forms": {
    "create": ["title", "owner_id", "likelihood", "impact", "description"],
    "edit": ["title", "owner_id", "likelihood", "impact", "status", "description"]
  },
  "events": ["risk.created", "risk.updated", "risk.closed"]
}

