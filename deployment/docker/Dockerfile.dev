# =============================================================================
# IdaraOS - Development Dockerfile
# =============================================================================
# Lightweight development image with volume mounts for hot reloading
# =============================================================================

FROM node:22-alpine

# Install pnpm globally
RUN corepack enable && corepack prepare pnpm@latest --activate

# Install development tools
RUN apk add --no-cache git

WORKDIR /app

# Copy package files for dependency installation
COPY package.json pnpm-lock.yaml pnpm-workspace.yaml ./
COPY apps/web/package.json ./apps/web/

# Install all dependencies (will be cached in image)
RUN pnpm install --frozen-lockfile

# Set development environment
ENV NODE_ENV=development
ENV NEXT_TELEMETRY_DISABLED=1
ENV PORT=3000
ENV HOSTNAME="0.0.0.0"

# Expose port
EXPOSE 3000

# Working directory for next dev
WORKDIR /app/apps/web

# Run Next.js dev server directly
CMD ["npx", "next", "dev", "--hostname", "0.0.0.0", "--port", "3000"]
